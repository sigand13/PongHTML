<!doctype html>
<html lang="sv">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Enkel Subway Surfers - HTML</title>
  <style>
    html,body{height:100%;margin:0;font-family:system-ui,Segoe UI,Roboto,Arial}
    #game{background:linear-gradient(#87CEEB,#B0E0E6);width:100%;height:100vh;overflow:hidden;position:relative}
    .ground{position:absolute;left:0;right:0;height:120px;bottom:0;background:linear-gradient(#444,#222)}
    .player{width:48px;height:64px;background:#ff4757;border-radius:8px;position:absolute;bottom:120px;left:80px;box-shadow:0 6px 0 rgba(0,0,0,.2)}
    .obstacle{width:40px;height:64px;background:#2f3542;border-radius:6px;position:absolute;bottom:120px;right:-60px}
    .score{position:absolute;left:16px;top:16px;background:rgba(255,255,255,.9);padding:8px 12px;border-radius:8px;font-weight:700}
    .instructions{position:absolute;right:16px;top:16px;background:rgba(255,255,255,.9);padding:8px 12px;border-radius:8px;font-size:13px}
    .game-over{position:absolute;left:50%;top:40%;transform:translate(-50%,-50%);background:rgba(0,0,0,.75);color:#fff;padding:18px 22px;border-radius:10px;text-align:center;display:none}
    button{margin-top:10px;padding:8px 12px;border-radius:8px;border:0;background:#ff4757;color:#fff;cursor:pointer}
  </style>
</head>
<body>
  <div id="game">
    <div class="score" id="score">Poäng: 0</div>
    <div class="instructions">Hoppa: mellanslag/uppåt • Vänster: A • Höger: D</div>
    <div class="ground"></div>
    <div class="player" id="player"></div>
    <div class="game-over" id="gameOver">
      <div id="goText">Game over</div>
      <div id="finalScore" style="margin-top:8px;font-weight:700"></div>
      <button id="restart">Spela igen</button>
    </div>
  </div>

  <script>
    const player = document.getElementById('player')
    const game = document.getElementById('game')
    const scoreEl = document.getElementById('score')
    const gameOverEl = document.getElementById('gameOver')
    const finalScore = document.getElementById('finalScore')
    const restartBtn = document.getElementById('restart')

    let vy = 0
    let vx = 0
    const gravity = 0.9
    const jumpImpulse = -16
    const groundY = 120
    let playerY = 0
    let playerX = 80
    let isRunning = true
    let obstacles = []
    let spawnTimer = 0
    let spawnInterval = 90
    let score = 0

    function createObstacle(){
      const el = document.createElement('div')
      el.className = 'obstacle'
      game.appendChild(el)
      const obj = {el, x: game.clientWidth, w: 40, h: 64}
      obstacles.push(obj)
    }

    function reset(){
      vy = 0
      vx = 0
      playerY = 0
      playerX = 80
      isRunning = true
      obstacles.forEach(o=>o.el.remove())
      obstacles = []
      spawnTimer = 0
      spawnInterval = 90
      score = 0
      scoreEl.textContent = 'Poäng: 0'
      gameOverEl.style.display = 'none'
    }

    function endGame(){
      isRunning = false
      finalScore.textContent = 'Poäng: ' + Math.floor(score)
      gameOverEl.style.display = 'block'
    }

    restartBtn.addEventListener('click', ()=>{
      reset()
      loop()
    })

    function collide(aX,aY,aW,aH,bX,bY,bW,bH){
      return aX < bX + bW && aX + aW > bX && aY < bY + bH && aY + aH > bY
    }

    let last = performance.now()
    function loop(now){
      if(!isRunning) return
      const dt = (now - last) / 16.6667
      last = now

      vy += gravity * dt
      playerY += vy * dt
      if(playerY > 0){
        playerY = 0
        vy = 0
      }

      playerX += vx * dt * 5
      if(playerX < 0) playerX = 0
      if(playerX > game.clientWidth - 60) playerX = game.clientWidth - 60

      player.style.left = playerX + 'px'
      player.style.bottom = groundY + playerY + 'px'

      spawnTimer++
      if(spawnTimer > spawnInterval){
        createObstacle()
        spawnTimer = 0
        if(spawnInterval > 40) spawnInterval -= 2
      }

      for(let i = obstacles.length-1; i>=0; i--){
        const o = obstacles[i]
        o.x -= 6 * dt
        o.el.style.right = (game.clientWidth - o.x - o.w) + 'px'

        const px = playerX
        const py = game.clientHeight - groundY - 64 + playerY
        const pw = 48
        const ph = 64
        const ox = o.x
        const oy = game.clientHeight - groundY - o.h

        if(collide(px,py,pw,ph, ox,oy,o.w,o.h)){
          endGame()
          return
        }

        if(o.x + o.w < -100){
          o.el.remove()
          obstacles.splice(i,1)
          score += 10
          scoreEl.textContent = 'Poäng: ' + Math.floor(score)
        }
      }

      score += 0.05 * dt
      scoreEl.textContent = 'Poäng: ' + Math.floor(score)

      requestAnimationFrame(loop)
    }

    function jump(){
      if(!isRunning) return
      if(playerY === 0){
        vy = jumpImpulse
      }
    }

    window.addEventListener('keydown', e=>{
      if(e.code === 'Space' || e.code === 'ArrowUp'){
        e.preventDefault()
        jump()
      }
      if(e.code === 'KeyA' || e.code === 'ArrowLeft'){
        vx = -2
      }
      if(e.code === 'KeyD' || e.code === 'ArrowRight'){
        vx = 2
      }
    })

    window.addEventListener('keyup', e=>{
      if(['KeyA','ArrowLeft','KeyD','ArrowRight'].includes(e.code)){
        vx = 0
      }
    })

    window.addEventListener('touchstart', e=>{
      e.preventDefault()
      jump()
    },{passive:false})

    reset()
    requestAnimationFrame(loop)
  </script>
</body>
</html>
